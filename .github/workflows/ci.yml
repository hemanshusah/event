name: Basic CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  # Simple validation job - no complex dependencies
  validate:
    name: Validate Project
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Check project structure
        run: |
          echo "ğŸ” Checking project structure..."
          echo "Root directory contents:"
          ls -la
          echo ""
          echo "Backend structure:"
          ls -la backend/api-gateway/
          echo ""
          echo "Web admin structure:"
          ls -la web-admin/
          echo ""
          echo "Mobile structure:"
          ls -la mobile-apps/ios/
          echo "âœ… Project structure is valid"

      - name: Check package.json files exist
        run: |
          echo "ğŸ“¦ Checking package.json files..."
          test -f package.json && echo "âœ… Root package.json exists"
          test -f backend/api-gateway/package.json && echo "âœ… Backend package.json exists"
          test -f web-admin/package.json && echo "âœ… Web admin package.json exists"
          test -f mobile-apps/ios/package.json && echo "âœ… Mobile package.json exists"
          echo "âœ… All package.json files found"

      - name: Check main source files exist
        run: |
          echo "ğŸ” Checking main source files..."
          test -f backend/api-gateway/src/server.js && echo "âœ… Backend server.js exists"
          test -f web-admin/src/App.js && echo "âœ… Web admin App.js exists"
          test -f mobile-apps/ios/App.js && echo "âœ… Mobile App.js exists"
          echo "âœ… All main source files exist"

      - name: Check routes and pages exist
        run: |
          echo "ğŸ” Checking routes and pages..."
          echo "Backend routes:"
          ls -la backend/api-gateway/src/routes/
          echo "Web admin pages:"
          ls -la web-admin/src/pages/
          echo "Mobile screens:"
          ls -la mobile-apps/ios/src/screens/
          echo "âœ… All routes and pages exist"

      - name: Validate file syntax (basic)
        run: |
          echo "ğŸ” Validating file syntax..."
          echo "Checking backend server file:"
          node -c backend/api-gateway/src/server.js && echo "âœ… Backend syntax valid"
          echo "Checking web admin app file:"
          node -c web-admin/src/App.js && echo "âœ… Web admin syntax valid"
          echo "Checking mobile app file:"
          node -c mobile-apps/ios/App.js && echo "âœ… Mobile syntax valid"
          echo "âœ… All file syntax is valid"

      - name: Check database schema exists
        run: |
          echo "ğŸ” Checking database files..."
          test -f database/schemas/01_create_tables.sql && echo "âœ… Database schema exists"
          test -f database/seeds/01_initial_data.sql && echo "âœ… Database seeds exist"
          echo "âœ… Database files exist"

      - name: Check Docker files exist
        run: |
          echo "ğŸ” Checking Docker files..."
          test -f backend/api-gateway/Dockerfile && echo "âœ… Backend Dockerfile exists"
          test -f web-admin/Dockerfile && echo "âœ… Web admin Dockerfile exists"
          test -f docker-compose.yml && echo "âœ… Docker compose exists"
          echo "âœ… Docker files exist"

      - name: Check documentation exists
        run: |
          echo "ğŸ” Checking documentation..."
          test -f README.md && echo "âœ… README exists"
          test -f DEVELOPMENT.md && echo "âœ… Development docs exist"
          test -f DEPLOYMENT.md && echo "âœ… Deployment docs exist"
          echo "âœ… Documentation exists"

      - name: Success message
        run: |
          echo "ğŸ‰ CI/CD Pipeline completed successfully!"
          echo "âœ… Project structure validated"
          echo "âœ… All source files exist"
          echo "âœ… File syntax is valid"
          echo "âœ… Database schema exists"
          echo "âœ… Docker configuration exists"
          echo "âœ… Documentation exists"
          echo "âœ… Ready for development"